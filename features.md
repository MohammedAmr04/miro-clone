# ğŸ¨ Project: Ultimate Whiteboard (Miro Clone ++)

## 1. ğŸŒŸ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© (Feature Set)

ÙŠÙ‡Ø¯Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ø¨Ù†Ø§Ø¡ Ù„ÙˆØ­Ø© Ø¨ÙŠØ¶Ø§Ø¡ ØªØ¹Ø§ÙˆÙ†ÙŠØ© ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ù…Ø±ÙˆÙ†Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„ÙŠØ¯ÙˆÙŠ (Excalidraw) ÙˆÙ‚ÙˆØ© Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ØªÙ‚Ù†ÙŠ (Mermaid) ÙˆØªÙ†Ø¸ÙŠÙ… (Lucidchart).

### A. Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª (Core Canvas)

- **Infinite Canvas**: Ù„ÙˆØ­Ø© ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø© Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ù€ Pan (Ø§Ù„ØªØ­Ø±ÙŠÙƒ) Ùˆ Zoom.
- **Basic Shapes**: Ù…Ø³ØªØ·ÙŠÙ„ØŒ Ø¯Ø§Ø¦Ø±Ø©ØŒ Ù…Ø¹ÙŠÙ†ØŒ Ù…Ø«Ù„Ø«.
- **Text & Sticky Notes**: ÙƒØªØ§Ø¨Ø© Ù†ØµÙˆØµ ÙˆÙ…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ø§ØµÙ‚Ø©.
- **Freehand Drawing**: Ù‚Ù„Ù… Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø­Ø± (Pencil tool).
- **Transformation**: ØªØ­Ø±ÙŠÙƒØŒ ØªØºÙŠÙŠØ± Ø­Ø¬Ù…ØŒ ÙˆØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ù†Ø§ØµØ±.

### B. Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† (Killer Feature #1: Mermaid) ğŸ¤–

- **Code-to-Diagram Widget**:
  - Ù…Ø±Ø¨Ø¹ Ø¥Ø¯Ø®Ø§Ù„ (Input Block) ÙŠÙ‚Ø¨Ù„ ÙƒÙˆØ¯ Mermaid.js.
  - ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ ÙÙˆØ±ÙŠØ§Ù‹ (Real-time render) Ø¥Ù„Ù‰ Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ SVG ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ ÙŠØ¯ÙˆÙŠÙ‹Ø§ (ÙŠØ¹Ø¯Ù„ Ø¹Ø¨Ø± Ø§Ù„ÙƒÙˆØ¯ ÙÙ‚Ø·).
  - Ù…Ø«Ø§Ù„: ÙƒØªØ§Ø¨Ø© `A --> B` ØªØªØ­ÙˆÙ„ Ù„Ù…Ø±Ø¨Ø¹ÙŠÙ† ÙˆØ³Ù‡Ù….

### C. Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Killer Feature #2: Hand-Drawn) âœï¸

- **Sloppy/Sketch Mode**: Ø²Ø± ØªØ­ÙˆÙŠÙ„ (Toggle) ÙŠØ¬Ø¹Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…Ø© ÙˆØ§Ù„Ø£Ø´ÙƒØ§Ù„ ØªØ¨Ø¯Ùˆ ÙˆÙƒØ£Ù†Ù‡Ø§ Ù…Ø±Ø³ÙˆÙ…Ø© Ø¨Ø§Ù„ÙŠØ¯ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© Rough.js).
- **Smart Connectors**: Ø®Ø·ÙˆØ· Ø°ÙƒÙŠØ© ØªØ±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„Ø£Ø´ÙƒØ§Ù„ (Binding)ØŒ ÙˆØªØªØ­Ø±Ùƒ Ù…Ø¹Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.

### D. Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Real-Time Collaboration) ğŸš€

- **Live Cursors**: Ø±Ø¤ÙŠØ© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø§ÙˆØ³ Ù„Ù„Ø¢Ø®Ø±ÙŠÙ† Ø¨Ø£Ø³Ù…Ø§Ø¦Ù‡Ù….
- **Broadcasting**: Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„ (Ø±Ø³Ù…ØŒ Ù…Ø³Ø­ØŒ ØªØ­Ø±ÙŠÙƒ) ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹ ÙÙŠ Ø£Ø¬Ø²Ø§Ø¡ Ù…Ù† Ø§Ù„Ø«Ø§Ù†ÙŠØ©.

---

## 2. ğŸ—„ï¸ Database Schema & Architecture

Ø³Ù†Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ **Next.js (Frontend)** Ùˆ **.NET Core (Backend)**. Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù‡ÙŠ **PostgreSQL** (Ù„Ø£Ù†Ù‡Ø§ Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ JSONB) Ø£Ùˆ SQL Server.

### Ø£) Ù…Ø®Ø·Ø· Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª (ER Diagram Overview)

```mermaid
graph LR
    User -- 1:N --> Board
    Collaborator -- N:1 --> Board
    Board -- 1:N --> BoardElement
```

### Ø¨) ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ (Schema Definition)

#### 1. Table: `Users`

| Column         | Type         | Description                     |
| :------------- | :----------- | :------------------------------ |
| `Id`           | UUID (PK)    | Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯                   |
| `Email`        | VARCHAR(255) | Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Unique)      |
| `PasswordHash` | TEXT         | ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø´ÙØ±Ø©             |
| `DisplayName`  | VARCHAR(100) | Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± ÙÙˆÙ‚ Ù…Ø¤Ø´Ø± Ø§Ù„Ù…Ø§ÙˆØ³ |

#### 2. Table: `Boards`

| Column      | Type         | Description   |
| :---------- | :----------- | :------------ |
| `Id`        | UUID (PK)    | Ù…Ø¹Ø±Ù Ø§Ù„Ù„ÙˆØ­Ø©   |
| `Title`     | VARCHAR(200) | Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ |
| `OwnerId`   | UUID (FK)    | ØµØ§Ø­Ø¨ Ø§Ù„Ù„ÙˆØ­Ø©   |
| `CreatedAt` | TIMESTAMP    | ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ |

#### 3. Table: `BoardElements` (The Core Table)

Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ®Ø²Ù† ÙƒÙ„ Ø´ÙŠØ¡ (Ù…Ø±Ø¨Ø¹ØŒ Ø®Ø·ØŒ ÙƒÙˆØ¯ mermaid).

| Column     | Type        | Description                                                   |
| :--------- | :---------- | :------------------------------------------------------------ |
| `Id`       | UUID (PK)   | Ù…Ø¹Ø±Ù Ø§Ù„Ø¹Ù†ØµØ± (ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡ ÙÙŠ Ø§Ù„Ù€ Frontend ØºØ§Ù„Ø¨Ø§Ù‹)               |
| `BoardId`  | UUID (FK)   | Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù‡Ø§ (Indexed)                                   |
| `Type`     | VARCHAR(50) | Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù†ØµØ±: `rect`, `ellipse`, `text`, `connector`, `mermaid` |
| `Data`     | JSONB       | **Ø£Ù‡Ù… Ø¹Ù…ÙˆØ¯**: ÙŠØ®Ø²Ù† ÙƒÙ„ Ø®ØµØ§Ø¦Øµ Ø§Ù„Ø´ÙƒÙ„ (Ø§Ù†Ø¸Ø± Ø§Ù„Ø£Ø³ÙÙ„)               |
| `ZIndex`   | INT         | ØªØ±ØªÙŠØ¨ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª (Ù…Ù† ÙÙˆÙ‚ Ù…Ù†)                                     |
| `IsLocked` | BOOLEAN     | Ù‡Ù„ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù‚ÙÙˆÙ„ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ø±ÙŠÙƒÙ‡ØŸ                              |

### Ø¬) Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (JSON Data Structure)

ÙƒÙŠÙ Ø³ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ Ø¹Ù…ÙˆØ¯ `Data` Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù†ØµØ±:

#### 1. Ø´ÙƒÙ„ Ù‡Ù†Ø¯Ø³ÙŠ (Shape):

```json
{
  "x": 100,
  "y": 200,
  "width": 150,
  "height": 100,
  "backgroundColor": "#ff0000",
  "strokeColor": "#000000",
  "roughness": 1,
  "text": "Hello World"
}
```

_(Note: `roughness`: 0 = Sharp, 1+ = Hand-drawn style)_

#### 2. ÙƒÙˆØ¯ Ù…ÙŠØ±Ù…ÙŠØ¯ (Mermaid Widget):

```json
{
  "x": 300,
  "y": 50,
  "code": "graph TD; A[Client] --> B[Server];",
  "scale": 1.5
}
```

#### 3. Ù…ÙˆØµÙ„ Ø°ÙƒÙŠ (Smart Connector):

```json
{
  "startElementId": "uuid-of-shape-A",
  "endElementId": "uuid-of-shape-B",
  "startPoint": { "x": 0, "y": 0 },
  "endPoint": { "x": 100, "y": 100 },
  "style": "dashed"
}
```

_(Note: `startPoint` is a fallback if no element is attached)_

---

## 3. ğŸ’» .NET Backend Implementation Guide

### 1. C# Models (DTOs)

Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙˆØ±Ø§Ø«Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù€ JSON Ø¨Ø°ÙƒØ§Ø¡.

```csharp
// Base Class
public class BoardElement
{
    public Guid Id { get; set; }
    public Guid BoardId { get; set; }
    public string Type { get; set; } // "rect", "mermaid", etc.
    public int ZIndex { get; set; }

    // This maps to the JSONB column
    public JsonDocument Data { get; set; }
}

// SignalR Hub Interface
public interface IBoardClient
{
    Task ReceiveShapeUpdate(BoardElement element);
    Task ReceiveCursorMove(Guid userId, double x, double y);
    Task ReceiveShapeDelete(Guid elementId);
}
```

### 2. SignalR Hub Logic

```csharp
public class BoardHub : Hub<IBoardClient>
{
    // Join a specific board channel
    public async Task JoinBoard(string boardId)
    {
        await Groups.AddToGroupAsync(Context.ConnectionId, boardId);
    }

    // Broadcast shape changes
    public async Task UpdateShape(string boardId, BoardElement element)
    {
        // 1. Save to DB (Service Call)
        // 2. Broadcast to others in the group
        await Clients.OtherInGroup(boardId).ReceiveShapeUpdate(element);
    }
}
```

---

## 4. ğŸ› ï¸ Roadmap & Step-by-Step Plan

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„ØªØ£Ø³ÙŠØ³ (Foundation & Canvas)

- [ ] **Setup**: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ Next.js ÙˆÙ…Ø´Ø±ÙˆØ¹ .NET API.
- [ ] **Canvas Lib**: ØªØ«Ø¨ÙŠØª `react-konva` (Ù„Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ) Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… SVG Ø¹Ø§Ø¯ÙŠ.
- [ ] **Basic Drawing**: Ø±Ø³Ù… Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª ÙˆØ§Ù„Ø¯ÙˆØ§Ø¦Ø± ÙˆØªØ­Ø±ÙŠÙƒÙ‡Ø§ (Local State only).
- [ ] **API & DB**: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ØŒ ÙˆØ¹Ù…Ù„ Endpoints Ù„Ù€ (Create Board, Get Board Elements).
- [ ] **Save/Load**: Ø±Ø¨Ø· Ø§Ù„Ù€ Frontend Ø¨Ø§Ù„Ù€ API Ù„Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ù…Ø© ÙˆØ§Ø³ØªØ±Ø¬Ø§Ø¹Ù‡Ø§.

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ© (The "Killer" Features)

- [ ] **Mermaid Integration**:
  - ØªØ«Ø¨ÙŠØª `mermaid` ÙÙŠ Ø§Ù„Ù€ Next.js.
  - Ø¹Ù…Ù„ Component Ø¬Ø¯ÙŠØ¯ `MermaidShape`.
  - Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒØªØ¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙˆØ¯ØŒ ÙŠØªÙ… Ø¹Ù…Ù„ `mermaid.render` ÙˆØªØ­ÙˆÙŠÙ„Ù‡ Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ Canvas.
- [ ] **Hand-Drawn Style**:
  - ØªØ«Ø¨ÙŠØª `roughjs`.
  - Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø±ØŒ ÙŠØªÙ… Ø±Ø³Ù… Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… `rough.canvas` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…Ø©.
- [ ] **Smart Lines**:
  - Ø¨Ø±Ù…Ø¬Ø© Ù…Ù†Ø·Ù‚ Ø±Ø³Ù… Ø§Ù„Ø®Ø· Ø¨ÙŠÙ† Ù†Ù‚Ø·ØªÙŠ Ù…Ø±ÙƒØ² Ø´ÙƒÙ„ÙŠÙ† (Center to Center).

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„Ù€ Real-time (SignalR)

- [ ] **Connection**: Ø¥Ø¹Ø¯Ø§Ø¯ SignalR Client ÙÙŠ Next.js.
- [ ] **Sync**: Ø¹Ù†Ø¯ Ø±Ø³Ù… Ø´ÙƒÙ„ØŒ Ø£Ø±Ø³Ù„ event Ù„Ù€ SignalRØŒ ÙˆØ¹Ù†Ø¯ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ eventØŒ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ React State.
- [ ] **Cursors**: Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù…Ø§ÙˆØ³ (Throttle every 50ms) Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±.

---

## 5. ğŸ“š Tech Stack Recommendations (Specific Libraries)

| Ø§Ù„Ù…Ø¬Ø§Ù„            | Ø§Ù„ØªÙ‚Ù†ÙŠØ©/Ø§Ù„Ù…ÙƒØªØ¨Ø©          | Ø§Ù„Ø³Ø¨Ø¨                                                                |
| :---------------- | :----------------------- | :------------------------------------------------------------------- |
| **Frontend**      | Next.js 14+ (App Router) | Ø§Ù„Ø£Ø­Ø¯Ø« ÙˆØ§Ù„Ø£Ø³Ø±Ø¹.                                                      |
| **Canvas**        | React Konva              | Ù…ÙƒØªØ¨Ø© Ù‚ÙˆÙŠØ© Ø¬Ø¯Ø§Ù‹ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù€ Canvas ÙˆØªØ¯Ø¹Ù… Ø§Ù„Ù€ Drag & Drop Ø¨Ø§Ù…ØªÙŠØ§Ø². |
| **Diagrams**      | Mermaid.js               | Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ©.                                         |
| **Sketchy Style** | Rough.js                 | Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ù„ØªØ¨Ø¯Ùˆ ÙŠØ¯ÙˆÙŠØ©.                                 |
| **State Mngt**    | Zustand                  | Ø£Ø®Ù ÙˆØ£Ø³Ù‡Ù„ Ù…Ù† Redux Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„Ù„ÙˆØ­Ø©.                    |
| **Backend**       | .NET 8 Web API           | Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹.                                                      |
| **Real-time**     | SignalR                  | Ø§Ù„Ø­Ù„ Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ ÙÙŠ Ø¯ÙˆØª Ù†Øª Ù„Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù„Ø­Ø¸ÙŠ.                               |
| **Database**      | PostgreSQL               | Ø¯Ø¹Ù… Ù…Ù…ØªØ§Ø² Ù„Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª JSONB.                                       |
| **ORM**           | Entity Framework Core    | Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¯Ø§ØªØ§ Ø¨ÙŠØ² Ø¨Ø³Ù‡ÙˆÙ„Ø©.                                        |
